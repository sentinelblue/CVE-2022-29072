imProcess
| where TimeGenerated > ago(365d)
| where  
    ActingProcessName has "hh.exe" 
    and ActingProcessCommandLine matches regex @".*\.chm$" 
    //and ActingProcessCommandLine matches regex @".*7-zip\.chm$" 
    //and TargetProcessName has_any ("cmd.exe","pwsh.exe","powershell.exe")


imProcess
| where TimeGenerated > ago(365d)
| where 
    (TargetProcessName has_any ("cmd.exe", "powershell.exe") and ActingProcessName matches regex @".*7zFM.exe$")
    and not(TargetProcessCommandLine has_any (".bat",".cmd",".ps1"))
